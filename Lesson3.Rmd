---
title: "Lesson3"
output: html_document
date: "2023-01-22"
---
## 背景

サンドボックスへようこそ! このアクティビティでは、このコースで学習する `R` でできることのいくつかをプレビューする機会を提供します。パッケージとデータの扱いについて学び、主な関数を試してみましょう。

このアクティビティでは、`R` パッケージをインストールして読み込んだり、関数を使用してデータを表示、クリーンアップ、可視化する練習をしたり、`R markdown` を使用して分析を文書化する方法について学んだりします。このサンドボックスアクティビティでは、 `R` の関数を実際に動かしながら、 `R` をより快適に使用することができます。このサンドボックスアクティビティでは、Rの機能を実際に示しながら、Rの使い方に慣れることができます。この後のアクティビティでは、あなた自身のRコードを書く機会もあります

## ステップ1: `R packages`を使う

パッケージは `R.` で作業をする上で重要な役割を果たします。パッケージには `関数` と呼ばれるコードの束が入っており、 `R.` で様々な作業を行うことができます。

いくつかの `パッケージ` はデフォルトでインストールされていますが、他の多くは Comprehensive R Archive Network, または CRAN のような外部のソースからダウンロードすることができます。

このアクティビティでは、`tidyverse`というパッケージを使用します。`tidyverse`パッケージは実際には、さまざまな分析タスクを実行するのに役立つ、個々の`パッケージ`を集めたものです。

`tidyverse`パッケージをインストールするには、右上の緑色の矢印ボタンをクリックして、以下のコードチャンクのコードを実行します。RMarkdownでコードチャンクを実行すると、その出力は.rmdエリアとコンソールに表示されます。

```{r}
install.packages("tidyverse")
```

`tidyverse` パッケージをインストールして読み込むのに数分かかるかもしれません--次のステップに進む前に、実行が終わるのを待つようにしてください

上のチャンクの実行が終わると、`library()`関数を実行したためにどのパッケージがロードされたかをまとめたレポートが表示されます。このレポートでは、衝突している `関数` があるかどうかも教えてくれますが、今のところ気にする必要はないでしょう。

これで `R パッケージ` がロードされたので、データの探索を開始することができます。

```{r}
library(tidyverse)
```
# ステップ2: データを見る

多くの `tidyverse` パッケージにはサンプルデータセットが含まれており、それを使って `R` のスキルを練習することができます。 `ggplot2`パッケージの`diamonds`データセットは、`R` 関数をプレビューするための素晴らしい例です。

最後のステップで既にこのパッケージをロードしているので、 `diamonds` データセットはすぐに使用することができます。

データをプレビューするために使用できる一般的な関数として、 `head()` 関数があります。これは、データの列と最初の数行を表示する関数です。以下のチャンクを実行することで、`head()`関数がどのように動作するかを試すことができます。

```{r}
head(diamonds)
```

```{r}
str(diamonds)
```



## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

```{r}
glimpse(diamonds)
```
```{r}
colnames(diamonds)
```

コードチャンクを実行した後、括弧内の数字に気づいたかもしれない。この数字は、データセットに含まれる列の数を数えるのに役立ちます。もしたくさんの列を持つデータがあって、 `colnames()` が結果を複数行に渡って表示する場合、それぞれの行の先頭には括弧内の数字が表示され、それが何番目の列かを示すことになります! たとえば、`diamonds` データセットでは "carat" が最初の列となります。2行目には括弧内に7という数字があり、"price"が7列目であることがわかる。

## Step 3: データをクリーンアップする

データアナリストとして最も頻繁に行わなければならない作業のひとつに、データのクリーンアップと整理があります。`R` を使えば、これが簡単にできます。重要なタスクを簡単かつ迅速に実行するために、多くの関数が用意されています。

例えば、データ中の列や変数の名前を変更する必要があるかもしれません。そのための関数があります。`rename()` がどのように動作するかは、以下のチャンクで確認できます。

```{r}
rename(diamonds, carat_new = carat)
```
ここでは、この関数を使用して `carat` の名前を `carat_new` に変更しています。これはかなり基本的な変更ですが、 `rename()` には多くのオプションがあり、データ内のすべての変数に対して、より複雑な変更を行うことができます。

たとえば、同じ `rename()` コードで複数の変数の名前を変更することができます。以下のコードは、その方法を示しています。

```{r}
rename(diamonds, carat_new = carat, cut_new = cut)
```

データを要約するのに便利なもう一つの関数が `summarize()` です。この関数を使うと、データの要約統計量を幅広く生成することができます。例えば、このデータセットにおける `carat` の平均値を知りたければ、以下のチャンクのコードを実行すればよいでしょう。

```{r}
summarize(diamonds, mean_carat = mean(carat))
```
これらの関数は、データをより身近に感じ、データについて考察を始めるための素晴らしい方法です。しかし、データセットを理解するためには、テーブルをプレビューするだけでは十分でないこともあります。幸いなことに、`R`にはビジュアライゼーションツールが内蔵されています。

## ステップ4：データのビジュアライゼーション

`R`を使えば、コードを少し変更するだけで、シンプルでわかりやすいビジュアライゼーションも、複雑で美しいビジュアライゼーションも作成できます。Rは、同じデータをさまざまな方法で表示することができるので、新しいインサイトを作成したり、重要なデータを強調したりするのに役立ちます。 最もよく使われるビジュアライゼーションパッケージの一つは `ggplot2` パッケージです。これは `tidyverse` をインストールして読み込むと自動的にロードされます。

`ggplot2`を使ってビジュアライゼーションを作成するには、プロット要素を`+`シンボルで重ね合わせます。このコースの後半では`ggplot2` の使用方法についてさらに多くのことを学びますが、ここではコードを使っていかに簡単かつ柔軟にビジュアル化を行うことができるかを紹介します。

```{r}
ggplot(data = diamonds, aes(x = carat, y = price)) +
  geom_point()
```
上のコードは `diamonds` データを受け取り、X 軸にカラット列、Y 軸に価格列をプロットし、 `geom_point()` コマンドを使用して散布図としてデータを表現しています。

`ggplot2` を使用すると、ビジュアライゼーションを簡単に変更したり改善したりすることができます。例えば、各ポイントの色を変えて、ダイヤモンドのカットのような別の変数を表すようにしたい場合、次のようにコードを変更することができます。

```{r}
ggplot(data = diamonds, aes(x = carat, y = price, color = cut)) +
  geom_point()
```

少々複雑なビジュアルですね。データのさまざまな側面をビジュアルで表現しようとするとき、構成要素のいくつかを分離することが役立つ場合があります。例えば、それぞれの切り口に対して異なるプロットを作成することができます。`ggplot2`では`facet_wrap()` 関数でこれを簡単に行うことができます。

```{r}
ggplot(data = diamonds, aes(x = carat, y = price, color = cut)) +
  geom_point() +
  facet_wrap(~cut)
```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
